<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MemoryBench | Benchmark Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Share+Tech+Mono&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        :root {
            /* CLEAN DARK THEME */
            --bg-primary: #0a0a0c;
            --bg-secondary: #0f0f12;
            --bg-card: #131318;
            --bg-hover: #1a1a20;
            --border-color: #252530;
            --border-hover: #3a3a48;
            
            /* Clean accent colors */
            --accent-cyan: #5eead4;
            --accent-pink: #f472b6;
            --accent-blue: #60a5fa;
            --accent-green: #4ade80;
            --accent-yellow: #facc15;
            --accent-orange: #fb923c;
            --accent-red: #f87171;
            --accent-purple: #a78bfa;
            
            /* Text colors */
            --text-primary: #e4e4e7;
            --text-secondary: #a1a1aa;
            --text-muted: #52525b;
            
            /* Provider colors */
            --color-supermemory: #5eead4;
            --color-zep: #fb923c;
            --color-mem0: #facc15;
            --color-fullcontext: #a78bfa;
            --color-langchain: #4ade80;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            background: var(--bg-primary);
        }

        body {
            font-family: 'Share Tech Mono', 'JetBrains Mono', monospace;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* CRT wrapper - disabled */
        .crt-wrapper {
            display: none;
        }

        /* No scan lines or effects */
        body::before,
        body::after {
            display: none;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 48px;
            padding-top: 10px;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 12px;
        }

        .logo-icon {
            width: 52px;
            height: 52px;
            background: var(--bg-card);
            border: 2px solid var(--accent-cyan);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
        }

        .logo-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 32px;
            font-weight: 700;
            color: var(--accent-cyan);
            letter-spacing: 4px;
            text-transform: uppercase;
        }

        .subtitle {
            font-family: 'Share Tech Mono', monospace;
            color: var(--text-secondary);
            font-size: 13px;
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        /* Benchmark Tabs */
        .tabs-container {
            display: flex;
            justify-content: center;
            margin-bottom: 32px;
        }

        .tabs {
            display: inline-flex;
            background: var(--bg-card);
            border-radius: 8px;
            padding: 4px;
            gap: 4px;
            border: 1px solid var(--border-color);
        }

        .tab {
            padding: 12px 28px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-family: 'Orbitron', sans-serif;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-radius: 6px;
        }

        .tab:hover {
            color: var(--text-primary);
            background: var(--bg-hover);
        }

        .tab.active {
            background: var(--accent-cyan);
            color: var(--bg-primary);
        }

        .tab::before {
            display: none;
        }

        /* Provider Controls */
        .controls {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .controls::before {
            display: none;
        }

        .controls-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 14px;
        }

        .controls-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .formal-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--text-secondary);
            cursor: pointer;
        }

        .formal-toggle input {
            width: 16px;
            height: 16px;
            accent-color: var(--accent-cyan);
            cursor: pointer;
        }

        .provider-toggles {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .provider-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .provider-toggle:hover {
            border-color: var(--border-hover);
            background: var(--bg-hover);
        }

        .provider-toggle.active {
            border-color: var(--accent-cyan);
            background: rgba(94, 234, 212, 0.1);
        }

        .provider-toggle input {
            display: none;
        }

        .provider-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
            flex-shrink: 0;
        }

        .provider-name {
            font-family: 'Share Tech Mono', monospace;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            text-transform: capitalize;
        }

        .provider-toggle:not(.active) .provider-name {
            color: var(--text-muted);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 14px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 18px;
            transition: all 0.2s ease;
        }

        .stat-card::before,
        .stat-card::after {
            display: none;
        }

        .stat-card:hover {
            border-color: var(--border-hover);
        }

        .stat-label {
            font-family: 'Share Tech Mono', monospace;
            font-size: 10px;
            color: var(--text-muted);
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .stat-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .stat-value.highlight {
            color: var(--accent-cyan);
        }

        .stat-suffix {
            font-size: 16px;
            color: var(--text-secondary);
        }

        /* Chart Section */
        .chart-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .chart-section::before {
            display: none;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .chart-subtitle {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .chart-container {
            position: relative;
            height: 400px;
        }

        /* Legend */
        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        .legend-label {
            font-family: 'Share Tech Mono', monospace;
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: capitalize;
        }

        /* Detailed Results Table */
        .details-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .details-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .provider-details {
            display: grid;
            gap: 14px;
        }

        .provider-detail-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.2s ease;
        }

        .provider-detail-card::after {
            display: none;
        }

        .provider-detail-card:hover {
            border-color: var(--border-hover);
        }

        .provider-detail-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 18px;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-hover);
        }

        .provider-detail-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 13px;
            font-weight: 600;
            color: var(--accent-cyan);
            text-transform: capitalize;
            letter-spacing: 1px;
        }

        .provider-detail-meta {
            font-size: 11px;
            color: var(--text-muted);
            margin-left: auto;
            font-family: 'Share Tech Mono', monospace;
        }

        .provider-detail-body {
            padding: 14px 18px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-size: 12px;
            color: var(--text-muted);
        }

        .detail-value {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            font-family: 'Share Tech Mono', monospace;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Loading & Error States */
        .loading, .no-data {
            text-align: center;
            padding: 80px 20px;
            color: var(--text-muted);
            font-size: 14px;
            letter-spacing: 2px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 2px solid var(--border-color);
            border-top-color: var(--accent-cyan);
            border-radius: 50%;
            margin: 0 auto 20px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error {
            background: rgba(248, 113, 113, 0.1);
            border: 1px solid var(--accent-red);
            border-radius: 8px;
            color: var(--accent-red);
            padding: 20px;
        }

        /* Collapsible Sections */
        .collapsible {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            margin-bottom: 16px;
            overflow: hidden;
            transition: all 0.2s ease;
        }

        .collapsible::before {
            display: none;
        }

        .collapsible:hover {
            border-color: var(--border-hover);
        }

        .collapsible-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }

        .collapsible-header:hover {
            background: var(--bg-hover);
        }

        .collapsible-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .collapsible-title .icon {
            font-size: 14px;
        }

        .collapsible-toggle {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            transition: transform 0.2s ease;
            font-size: 10px;
        }

        .collapsible.collapsed .collapsible-toggle {
            transform: rotate(-90deg);
        }

        .collapsible-content {
            padding: 0 20px 20px 20px;
        }

        .collapsible.collapsed .collapsible-content {
            display: none;
        }

        /* Dataset Statistics Section */
        .dataset-stats-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .dataset-stats-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .dataset-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 16px;
        }

        .stats-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 18px;
            transition: all 0.2s ease;
        }

        .stats-card::before {
            display: none;
        }

        .stats-card:hover {
            border-color: var(--border-hover);
        }

        .stats-card-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 10px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 14px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .stats-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .stats-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stats-item-label {
            font-size: 12px;
            color: var(--text-muted);
        }

        .stats-item-value {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            font-family: 'Share Tech Mono', monospace;
        }

        .stats-item-value.highlight {
            color: var(--accent-cyan);
            font-size: 16px;
        }

        .category-bar {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 6px 0;
        }

        .category-bar-label {
            font-size: 11px;
            color: var(--text-secondary);
            min-width: 120px;
        }

        .category-bar-track {
            flex: 1;
            height: 6px;
            background: var(--bg-primary);
            border-radius: 3px;
            overflow: hidden;
        }

        .category-bar-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.4s ease;
        }

        .category-bar-value {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-primary);
            font-family: 'Share Tech Mono', monospace;
            min-width: 60px;
            text-align: right;
            margin-bottom: 24px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 24px 16px;
            }
            
            .tabs {
                width: 100%;
                flex-direction: column;
                clip-path: none;
            }
            
            .tab {
                text-align: center;
            }
            
            .chart-container {
                height: 300px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Run History */
        .history-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            padding: 32px;
            margin-bottom: 32px;
            clip-path: polygon(0 0, calc(100% - 20px) 0, 100% 20px, 100% 100%, 20px 100%, 0 calc(100% - 20px));
        }

        .history-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: var(--neon-cyan);
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: var(--glow-cyan-soft);
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
        }

        .history-table th,
        .history-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .history-table th {
            font-family: 'Orbitron', sans-serif;
            font-size: 10px;
            font-weight: 600;
            color: var(--neon-cyan);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .history-table td {
            font-size: 13px;
            color: var(--text-primary);
        }

        .history-table tr:hover td {
            background: rgba(0, 255, 255, 0.05);
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            font-size: 10px;
            font-weight: 500;
            font-family: 'Share Tech Mono', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 1px solid;
        }

        .badge-formal {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--neon-green);
            color: var(--neon-green);
        }

        .badge-test {
            background: rgba(136, 136, 170, 0.1);
            border-color: var(--text-muted);
            color: var(--text-muted);
        }

        /* Neon Glow Animations */
        @keyframes neon-flicker {
            0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
                text-shadow: var(--glow-cyan-soft);
                opacity: 1;
            }
            20%, 24%, 55% {
                text-shadow: none;
                opacity: 0.8;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--border-hover);
        }

        /* Selection Color */
        ::selection {
            background: rgba(94, 234, 212, 0.3);
            color: #ffffff;
        }

        /* Focus States */
        input:focus, button:focus {
            outline: 2px solid var(--accent-cyan);
            outline-offset: 2px;
        }

        /* Global Link Styles */
        a {
            color: var(--accent-cyan);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        a:hover {
            color: var(--accent-pink);
        }

        /* Code/Pre Elements */
        code, pre {
            font-family: 'Share Tech Mono', monospace;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--accent-cyan);
            padding: 2px 6px;
        }

        /* Tab Content Animation */
        .tab-content {
            display: none;
            animation: fadeIn 0.2s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- CRT Effect Overlay -->
    <div class="crt-wrapper"></div>
    
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">üìä</div>
                <span class="logo-text">MemoryBench</span>
            </div>
            <p class="subtitle">Comparative Performance Analysis Across Memory Providers</p>
        </header>

        <!-- Benchmark Tabs -->
        <div class="tabs-container">
            <div class="tabs" id="benchmark-tabs">
                <!-- Populated dynamically -->
            </div>
        </div>

        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            Loading benchmark data...
        </div>

        <!-- Error State -->
        <div id="error" class="error" style="display: none;"></div>

        <!-- NoLiMa Tab -->
        <div id="nolima-content" class="tab-content">
            <!-- Provider Controls -->
            <div class="collapsible" data-section="nolima-controls">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">‚öôÔ∏è</span> Provider Controls</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="controls-header" style="margin-bottom: 16px;">
                        <label class="formal-toggle">
                            <input type="checkbox" id="nolima-formal-only" checked>
                            Formal runs only
                        </label>
                    </div>
                    <div id="nolima-providers" class="provider-toggles"></div>
                </div>
            </div>

            <!-- Stats -->
            <div class="collapsible" data-section="nolima-stats-section">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìä</span> Overview Stats</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div id="nolima-stats" class="stats-grid" style="margin-bottom: 0;"></div>
                </div>
            </div>

            <!-- Main Chart -->
            <div class="collapsible" data-section="nolima-chart-section">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìà</span> Accuracy by Context Length</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="chart-container">
                        <canvas id="nolima-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Dataset Statistics -->
            <div class="collapsible collapsed" data-section="nolima-dataset-stats" id="nolima-dataset-stats">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìã</span> Dataset Statistics</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="dataset-stats-grid">
                        <!-- Populated dynamically -->
                    </div>
                </div>
            </div>

            <!-- Provider Details -->
            <div class="collapsible collapsed" data-section="nolima-details" id="nolima-details">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üîç</span> Provider Details</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="provider-details"></div>
                </div>
            </div>
        </div>

        <!-- LongMemEval Tab -->
        <div id="longmemeval-content" class="tab-content">
            <!-- Provider Controls -->
            <div class="collapsible" data-section="longmemeval-controls">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">‚öôÔ∏è</span> Provider Controls</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="controls-header" style="margin-bottom: 16px;">
                        <label class="formal-toggle">
                            <input type="checkbox" id="longmemeval-formal-only" checked>
                            Formal runs only
                        </label>
                </div>
                    <div id="longmemeval-providers" class="provider-toggles"></div>
                </div>
            </div>

            <!-- Stats -->
            <div class="collapsible" data-section="longmemeval-stats-section">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìä</span> Overview Stats</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div id="longmemeval-stats" class="stats-grid" style="margin-bottom: 0;"></div>
                </div>
            </div>

            <!-- Main Chart -->
            <div class="collapsible" data-section="longmemeval-chart-section">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìà</span> Accuracy by Question Type</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="chart-container">
                        <canvas id="longmemeval-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Dataset Statistics -->
            <div class="collapsible collapsed" data-section="longmemeval-dataset-stats" id="longmemeval-dataset-stats">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìã</span> Dataset Statistics</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="dataset-stats-grid">
                        <!-- Populated dynamically -->
                    </div>
                </div>
            </div>

            <!-- Provider Details -->
            <div class="collapsible collapsed" data-section="longmemeval-details" id="longmemeval-details">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üîç</span> Provider Details</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="provider-details"></div>
                </div>
            </div>
        </div>

        <!-- LoCoMo Tab -->
        <div id="locomo-content" class="tab-content">
            <!-- Provider Controls -->
            <div class="collapsible" data-section="locomo-controls">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">‚öôÔ∏è</span> Provider Controls</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="controls-header" style="margin-bottom: 16px;">
                        <label class="formal-toggle">
                            <input type="checkbox" id="locomo-formal-only" checked>
                            Formal runs only
                        </label>
                    </div>
                    <div id="locomo-providers" class="provider-toggles"></div>
                </div>
            </div>

            <!-- Stats -->
            <div class="collapsible" data-section="locomo-stats-section">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìä</span> Overview Stats</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div id="locomo-stats" class="stats-grid" style="margin-bottom: 0;"></div>
                </div>
            </div>

            <!-- Main Chart -->
            <div class="collapsible" data-section="locomo-chart-section">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìà</span> Accuracy by Category</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="chart-container">
                        <canvas id="locomo-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Dataset Statistics - Moved below chart -->
            <div class="collapsible collapsed" data-section="locomo-dataset-stats" id="locomo-dataset-stats">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìã</span> Dataset Statistics</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="dataset-stats-grid">
                        <!-- Populated dynamically -->
                    </div>
                </div>
            </div>

            <!-- Category Distribution -->
            <div class="collapsible collapsed" data-section="locomo-distribution">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üéØ</span> Question Distribution</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div id="locomo-category-distribution"></div>
                </div>
            </div>

            <!-- Provider Details -->
            <div class="collapsible collapsed" data-section="locomo-details" id="locomo-details">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üîç</span> Provider Details</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="provider-details"></div>
                </div>
            </div>
        </div>

        <!-- No Data State -->
        <div id="no-data" class="no-data" style="display: none;">
            <p>No benchmark results found.</p>
            <p style="margin-top: 8px; font-size: 14px;">Run some benchmarks with the <code>--formal</code> flag to see results here.</p>
        </div>
    </div>

    <script>
        // ============================================================================
        // State
        // ============================================================================
        
        let config = {};
        let allData = null;
        let charts = {};
        let activeTab = 'nolima';
        let selectedProviders = {
            nolima: new Set(),
            longmemeval: new Set(),
            locomo: new Set(),
        };

        const PROVIDER_COLORS = {
            supermemory: '#5eead4',
            zep: '#fb923c',
            mem0: '#facc15',
            fullcontext: '#a78bfa',
            langchain: '#4ade80',
        };

        // ============================================================================
        // Collapsible Sections
        // ============================================================================

        function toggleCollapsible(headerElement) {
            const section = headerElement.parentElement;
            section.classList.toggle('collapsed');
            
            // Save state to localStorage
            const sectionId = section.dataset.section;
            if (sectionId) {
                const collapsed = section.classList.contains('collapsed');
                localStorage.setItem(`collapse-${sectionId}`, collapsed);
            }
        }

        function restoreCollapsibleStates() {
            document.querySelectorAll('.collapsible[data-section]').forEach(section => {
                const sectionId = section.dataset.section;
                const saved = localStorage.getItem(`collapse-${sectionId}`);
                if (saved === 'true') {
                    section.classList.add('collapsed');
                } else if (saved === 'false') {
                    section.classList.remove('collapsed');
                }
            });
        }

        // ============================================================================
        // Initialization
        // ============================================================================

        async function init() {
            try {
                // Load config
                const configRes = await fetch('/api/config');
                config = await configRes.json();
                Object.assign(PROVIDER_COLORS, config.providerColors || {});

                // Load data
                await loadData();
                
                // Setup tabs
                setupTabs();
                
                // Restore collapsible states
                restoreCollapsibleStates();
                
                // Hide loading
                document.getElementById('loading').style.display = 'none';
                
            } catch (error) {
                console.error('Init error:', error);
                document.getElementById('loading').style.display = 'none';
                showError('Failed to load benchmark data: ' + error.message);
            }
        }

        let datasetStats = null;

        async function loadData() {
            const formalOnly = true;
            const [aggregatedRes, statsRes] = await Promise.all([
                fetch(`/api/aggregated?formalOnly=${formalOnly}`),
                fetch('/api/dataset-stats'),
            ]);
            
            allData = await aggregatedRes.json();
            datasetStats = await statsRes.json();
            
            if (!allData.benchmarks || allData.benchmarks.length === 0) {
                document.getElementById('no-data').style.display = 'block';
                return;
            }

            // Initialize selected providers (all on by default)
            allData.noLiMa.forEach(r => selectedProviders.nolima.add(r.provider));
            allData.longMemEval.forEach(r => selectedProviders.longmemeval.add(r.provider));
            allData.loCoMo.forEach(r => selectedProviders.locomo.add(r.provider));

            renderAll();
        }

        function showError(message) {
            const errorEl = document.getElementById('error');
            errorEl.textContent = message;
            errorEl.style.display = 'block';
        }

        // ============================================================================
        // Tabs
        // ============================================================================

        function setupTabs() {
            const tabsContainer = document.getElementById('benchmark-tabs');
            const benchmarks = [
                { id: 'nolima', label: 'NoLiMa' },
                { id: 'longmemeval', label: 'LongMemEval' },
                { id: 'locomo', label: 'LoCoMo' },
            ];

            tabsContainer.innerHTML = benchmarks.map(b => `
                <button class="tab ${b.id === activeTab ? 'active' : ''}" data-tab="${b.id}">
                    ${b.label}
                </button>
            `).join('');

            // Add click handlers
            tabsContainer.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    setActiveTab(tab.dataset.tab);
                });
            });

            // Show initial tab
            setActiveTab(activeTab);
        }

        function setActiveTab(tabId) {
            activeTab = tabId;
            
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.tab === tabId);
            });

            // Update content visibility
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.toggle('active', content.id === `${tabId}-content`);
            });
        }

        // ============================================================================
        // Rendering
        // ============================================================================

        function renderAll() {
            renderDatasetStats();
            renderNoLiMa();
            renderLongMemEval();
            renderLoCoMo();
        }

        // ============================================================================
        // Dataset Statistics
        // ============================================================================

        function renderDatasetStats() {
            if (!datasetStats) return;
            
            // NoLiMa Dataset Stats
            if (datasetStats.nolima) {
                const stats = datasetStats.nolima;
                const container = document.querySelector('#nolima-dataset-stats .dataset-stats-grid');
                if (container) {
                    const lengthColors = ['#5eead4', '#a78bfa', '#4ade80', '#fb923c', '#f87171'];
                    
                    container.innerHTML = `
                        <div class="stats-card" style="text-align: center;">
                            <div style="font-family: 'Orbitron', sans-serif; font-size: 36px; font-weight: 700; color: var(--accent-cyan);">${stats.totalTests}</div>
                            <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 1px;">Total Test Cases</div>
                            <div style="margin-top: 14px; padding-top: 14px; border-top: 1px solid var(--border-color);">
                                <span style="font-family: 'Orbitron', sans-serif; font-weight: 600; color: var(--text-primary);">${stats.testsPerLength}</span>
                                <span style="font-size: 11px; color: var(--text-muted); margin-left: 4px;">per context</span>
                            </div>
                        </div>
                        
                        <div class="stats-card" style="text-align: center;">
                            <div style="font-family: 'Orbitron', sans-serif; font-size: 36px; font-weight: 700; color: var(--accent-purple);">${stats.contextLengths.length}</div>
                            <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 1px;">Context Lengths</div>
                            <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 6px; margin-top: 14px; padding-top: 14px; border-top: 1px solid var(--border-color);">
                                ${stats.contextLengths.map((len, i) => `
                                    <div style="padding: 4px 10px; background: ${lengthColors[i]}15; border: 1px solid ${lengthColors[i]}40; border-radius: 4px;">
                                        <span style="font-family: 'Share Tech Mono', monospace; font-weight: 600; color: ${lengthColors[i]};">${len}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="stats-card" style="text-align: center;">
                            <div style="font-family: 'Orbitron', sans-serif; font-size: 36px; font-weight: 700; color: var(--accent-green);">32K</div>
                            <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 1px;">Max Context</div>
                            <div style="margin-top: 14px; padding-top: 14px; border-top: 1px solid var(--border-color);">
                                <span style="font-size: 11px; color: var(--text-muted);">Memory retrieval at scale</span>
                            </div>
                        </div>
                    `;
                }
            }
            
            // LongMemEval Dataset Stats
            if (datasetStats.longmemeval) {
                const stats = datasetStats.longmemeval;
                const container = document.querySelector('#longmemeval-dataset-stats .dataset-stats-grid');
                if (container) {
                    const typeColors = {
                        'single-session-user': '#5eead4',
                        'single-session-assistant': '#a78bfa',
                        'single-session-preference': '#60a5fa',
                        'knowledge-update': '#4ade80',
                        'temporal-reasoning': '#fb923c',
                        'multi-session': '#f87171',
                    };
                    
                    container.innerHTML = `
                        <div class="stats-card" style="text-align: center;">
                            <div style="font-family: 'Orbitron', sans-serif; font-size: 36px; font-weight: 700; color: var(--accent-cyan);">${stats.totalQuestions}</div>
                            <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 1px;">Total Questions</div>
                            <div style="margin-top: 14px; padding-top: 14px; border-top: 1px solid var(--border-color);">
                                <span style="font-family: 'Orbitron', sans-serif; font-weight: 600; color: var(--text-primary);">${stats.questionTypes.length}</span>
                                <span style="font-size: 11px; color: var(--text-muted); margin-left: 4px;">types</span>
                            </div>
                        </div>
                        
                        <div class="stats-card" style="text-align: center; grid-column: span 2;">
                            <div style="font-size: 12px; font-weight: 600; color: var(--text-secondary); margin-bottom: 14px; text-transform: uppercase; letter-spacing: 1px;">Question Distribution</div>
                            <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 8px;">
                                ${stats.questionTypes.map(qt => `
                                    <div style="padding: 6px 12px; background: ${typeColors[qt.type]}15; border: 1px solid ${typeColors[qt.type]}40; border-radius: 4px;">
                                        <span style="font-family: 'Share Tech Mono', monospace; font-weight: 600; color: ${typeColors[qt.type]};">${qt.count}</span>
                                        <span style="font-size: 10px; color: var(--text-muted); margin-left: 6px;">${qt.label.replace('Single-Session ', 'SS ')}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            }
            
            // LoCoMo Dataset Stats
            if (datasetStats.locomo) {
                const stats = datasetStats.locomo;
                const container = document.querySelector('#locomo-dataset-stats .dataset-stats-grid');
                
                const categoryColors = {
                    1: '#a78bfa',
                    2: '#60a5fa',
                    3: '#4ade80',
                    4: '#fb923c',
                    5: '#f87171',
                };
                
                container.innerHTML = `
                    <div class="stats-card" style="text-align: center;">
                        <div style="font-family: 'Orbitron', sans-serif; font-size: 36px; font-weight: 700; color: var(--accent-cyan);">${stats.conversations.total}</div>
                        <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 1px;">Conversations</div>
                        <div style="display: flex; justify-content: center; gap: 16px; margin-top: 14px; padding-top: 14px; border-top: 1px solid var(--border-color);">
                            <div><span style="font-weight: 600; color: var(--text-primary);">${stats.conversations.avgSessions}</span><br><span style="font-size: 10px; color: var(--text-muted);">Sessions</span></div>
                            <div><span style="font-weight: 600; color: var(--text-primary);">${stats.conversations.avgTurns}</span><br><span style="font-size: 10px; color: var(--text-muted);">Turns</span></div>
                            <div><span style="font-weight: 600; color: var(--text-primary);">${(stats.conversations.avgTokens/1000).toFixed(1)}K</span><br><span style="font-size: 10px; color: var(--text-muted);">Tokens</span></div>
                        </div>
                    </div>
                    
                    <div class="stats-card" style="text-align: center;">
                        <div style="font-family: 'Orbitron', sans-serif; font-size: 36px; font-weight: 700; color: var(--accent-cyan);">${stats.questions.total.toLocaleString()}</div>
                        <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 1px;">Questions</div>
                        <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 6px; margin-top: 14px; padding-top: 14px; border-top: 1px solid var(--border-color);">
                            ${stats.questions.byCategory.map(cat => `
                                <div style="padding: 4px 10px; background: ${categoryColors[cat.category]}15; border: 1px solid ${categoryColors[cat.category]}40; border-radius: 4px;">
                                    <span style="font-family: 'Share Tech Mono', monospace; font-weight: 600; color: ${categoryColors[cat.category]};">${cat.count}</span>
                                    <span style="font-size: 9px; color: var(--text-muted); margin-left: 4px;">${cat.name.split(' ')[0]}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="stats-card" style="text-align: center;">
                        <div style="font-family: 'Orbitron', sans-serif; font-size: 36px; font-weight: 700; color: var(--accent-pink);">${stats.multimodal.totalImages}</div>
                        <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 1px;">Images</div>
                        <div style="margin-top: 14px; padding-top: 14px; border-top: 1px solid var(--border-color);">
                            <span style="font-weight: 600; color: var(--text-primary);">${stats.multimodal.avgImages}</span>
                            <span style="font-size: 10px; color: var(--text-muted); margin-left: 4px;">per conv</span>
                        </div>
                    </div>
                `;
                
                // Also populate the distribution section
                const distContainer = document.getElementById('locomo-category-distribution');
                if (distContainer) {
                    distContainer.innerHTML = `
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; padding: 16px 0;">
                            ${stats.questions.byCategory.map(cat => `
                                <div style="text-align: center; padding: 16px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px;">
                                    <div style="font-family: 'Orbitron', sans-serif; font-size: 24px; font-weight: 700; color: ${categoryColors[cat.category]};">
                                        ${cat.count}
                                    </div>
                                    <div style="font-size: 10px; color: var(--text-muted); margin-top: 6px; text-transform: uppercase;">
                                        ${cat.name}
                                    </div>
                                    <div style="font-family: 'Share Tech Mono', monospace; font-size: 12px; color: var(--text-secondary); margin-top: 4px;">
                                        ${cat.percentage}%
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                }
            }
        }

        function renderNoLiMa() {
            const data = allData.noLiMa;
            if (data.length === 0) return;

            // Render provider toggles
            renderProviderToggles('nolima', data);
            
            // Render stats
            renderStats('nolima', data);
            
            // Render chart
            renderNoLiMaChart(data);
            
            // Render details
            renderNoLiMaDetails(data);
        }

        function renderLongMemEval() {
            const data = allData.longMemEval;
            if (data.length === 0) return;

            renderProviderToggles('longmemeval', data);
            renderStats('longmemeval', data);
            renderLongMemEvalChart(data);
            renderLongMemEvalDetails(data);
        }

        function renderLoCoMo() {
            const data = allData.loCoMo;
            if (data.length === 0) return;

            renderProviderToggles('locomo', data);
            renderStats('locomo', data);
            renderLoCoMoChart(data);
            renderLoCoMoDetails(data);
        }

        function renderProviderToggles(benchmark, data) {
            const container = document.getElementById(`${benchmark}-providers`);
            const providers = [...new Set(data.map(r => r.provider))];
            
            container.innerHTML = providers.map(provider => {
                const isActive = selectedProviders[benchmark].has(provider);
                const color = PROVIDER_COLORS[provider] || '#6B7280';
                return `
                    <label class="provider-toggle ${isActive ? 'active' : ''}" data-provider="${provider}">
                        <input type="checkbox" ${isActive ? 'checked' : ''}>
                        <span class="provider-color" style="background: ${color}"></span>
                        <span class="provider-name">${provider}</span>
                    </label>
                `;
            }).join('');

            // Add change handlers
            container.querySelectorAll('.provider-toggle').forEach(toggle => {
                toggle.addEventListener('click', (e) => {
                    const provider = toggle.dataset.provider;
                    const checkbox = toggle.querySelector('input');
                    
                    if (e.target !== checkbox) {
                        checkbox.checked = !checkbox.checked;
                    }
                    
                    toggle.classList.toggle('active', checkbox.checked);
                    
                    if (checkbox.checked) {
                        selectedProviders[benchmark].add(provider);
                    } else {
                        selectedProviders[benchmark].delete(provider);
                    }
                    
                    // Re-render chart, stats, and details
                    if (benchmark === 'nolima') {
                        renderNoLiMaChart(allData.noLiMa);
                        renderStats('nolima', allData.noLiMa);
                        renderNoLiMaDetails(allData.noLiMa);
                    } else if (benchmark === 'longmemeval') {
                        renderLongMemEvalChart(allData.longMemEval);
                        renderStats('longmemeval', allData.longMemEval);
                        renderLongMemEvalDetails(allData.longMemEval);
                    } else if (benchmark === 'locomo') {
                        renderLoCoMoChart(allData.loCoMo);
                        renderStats('locomo', allData.loCoMo);
                        renderLoCoMoDetails(allData.loCoMo);
                    }
                });
            });
        }

        function renderStats(benchmark, data) {
            const container = document.getElementById(`${benchmark}-stats`);
            const filteredData = data.filter(r => selectedProviders[benchmark].has(r.provider));
            
            if (filteredData.length === 0) {
                container.innerHTML = '';
                return;
            }

            // Find best accuracy
            const bestAccuracy = Math.max(...filteredData.map(r => r.accuracy));
            const bestProvider = filteredData.find(r => r.accuracy === bestAccuracy);
            
            // Total questions
            const totalQuestions = filteredData.reduce((sum, r) => sum + (r.totalTests || r.totalQuestions || 0), 0);
            
            container.innerHTML = `
                <div class="stat-card">
                    <div class="stat-label">Best Accuracy</div>
                    <div class="stat-value highlight">${bestAccuracy.toFixed(1)}<span class="stat-suffix">%</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Top Provider</div>
                    <div class="stat-value" style="font-size: 18px; color: var(--accent-pink);">${bestProvider?.provider || '-'}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Providers</div>
                    <div class="stat-value">${filteredData.length}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Tests</div>
                    <div class="stat-value">${totalQuestions.toLocaleString()}</div>
                </div>
            `;
        }

        // ============================================================================
        // Charts
        // ============================================================================

        function renderNoLiMaChart(data) {
            const ctx = document.getElementById('nolima-chart');
            const filteredData = data.filter(r => selectedProviders.nolima.has(r.provider));
            
            if (charts.nolima) charts.nolima.destroy();
            
            // Handle no data case
            if (filteredData.length === 0) {
                charts.nolima = new Chart(ctx, {
                    type: 'bar',
                    data: { labels: [], datasets: [] },
                    options: getChartOptions('Accuracy (%)', [])
                });
                return;
            }
            
            // Context lengths as labels
            const labels = ['1K', '4K', '8K', '16K', '32K'];
            
            const datasets = filteredData.map(run => ({
                label: run.provider,
                data: labels.map(len => {
                    const ctxData = run.byContextLength?.find(c => c.contextLength === len);
                    return ctxData ? ctxData.accuracy : 0;
                }),
                backgroundColor: PROVIDER_COLORS[run.provider] || '#6B7280',
                borderColor: PROVIDER_COLORS[run.provider] || '#6B7280',
                borderWidth: 0,
                borderRadius: 4,
            }));

            charts.nolima = new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets },
                options: getChartOptions('Accuracy (%)', datasets)
            });
        }

        function renderLongMemEvalChart(data) {
            const ctx = document.getElementById('longmemeval-chart');
            const filteredData = data.filter(r => selectedProviders.longmemeval.has(r.provider));
            
            if (charts.longmemeval) charts.longmemeval.destroy();
            
            // Handle no data case
            if (filteredData.length === 0) {
                charts.longmemeval = new Chart(ctx, {
                    type: 'bar',
                    data: { labels: [], datasets: [] },
                    options: getChartOptions('Accuracy (%)', [])
                });
                return;
            }
            
            const labelMap = config.longMemEvalLabels || {
                'single-session-user': 'Single-Session User',
                'single-session-assistant': 'Single-Session Assistant',
                'single-session-preference': 'Single-Session Preference',
                'knowledge-update': 'Knowledge Update',
                'temporal-reasoning': 'Temporal Reasoning',
                'multi-session': 'Multi-Session',
            };
            
            const questionTypes = Object.keys(labelMap);
            const labels = questionTypes.map(qt => labelMap[qt]);
            
            const datasets = filteredData.map(run => ({
                label: run.provider,
                data: questionTypes.map(qt => {
                    const qtype = run.byQuestionType?.find(q => q.questionType === qt);
                    return qtype ? qtype.accuracy : 0;
                }),
                backgroundColor: PROVIDER_COLORS[run.provider] || '#6B7280',
                borderColor: PROVIDER_COLORS[run.provider] || '#6B7280',
                borderWidth: 0,
                borderRadius: 4,
            }));

            charts.longmemeval = new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets },
                options: getChartOptions('Accuracy (%)', datasets)
            });
        }

        function renderLoCoMoChart(data) {
            const ctx = document.getElementById('locomo-chart');
            const filteredData = data.filter(r => selectedProviders.locomo.has(r.provider));
            
            if (charts.locomo) charts.locomo.destroy();
            
            // Handle no data case
            if (filteredData.length === 0) {
                charts.locomo = new Chart(ctx, {
                    type: 'bar',
                    data: { labels: [], datasets: [] },
                    options: getChartOptions('Accuracy (%)', [])
                });
                return;
            }
            
            const categoryLabels = {
                1: 'Single-hop Factual',
                2: 'Temporal Reasoning',
                3: 'Multi-hop Reasoning',
                4: 'Simple Factual',
                5: 'Adversarial',
            };
            
            const categories = [1, 2, 3, 4, 5];
            const labels = categories.map(c => categoryLabels[c]);
            
            const datasets = filteredData.map(run => ({
                label: run.provider,
                data: categories.map(cat => {
                    const category = run.byCategory?.find(c => c.category === cat);
                    return category ? category.accuracy : 0;
                }),
                backgroundColor: PROVIDER_COLORS[run.provider] || '#6B7280',
                borderColor: PROVIDER_COLORS[run.provider] || '#6B7280',
                borderWidth: 0,
                borderRadius: 4,
            }));

            charts.locomo = new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets },
                options: getChartOptions('Accuracy (%)', datasets)
            });
        }

        function getChartOptions(yAxisLabel, datasets = []) {
            // Calculate dynamic Y-axis based on data
            let allValues = [];
            datasets.forEach(ds => {
                if (ds.data) allValues = allValues.concat(ds.data.filter(v => v > 0));
            });
            
            // Set min to (lowest value - 10) floored to nearest 5, but not below 0
            // Set max to (highest value + 5) ceiled to nearest 5, but not above 100
            const minValue = allValues.length > 0 ? Math.min(...allValues) : 0;
            const maxValue = allValues.length > 0 ? Math.max(...allValues) : 100;
            
            const yMin = Math.max(0, Math.floor((minValue - 10) / 5) * 5);
            const yMax = Math.min(100, Math.ceil((maxValue + 5) / 5) * 5);
            
            return {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 400,
                    easing: 'easeOutQuart',
                },
                transitions: {
                    active: {
                        animation: {
                            duration: 200
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: true,
                        position: 'top',
                        labels: {
                            color: '#a1a1aa',
                            font: { family: 'Share Tech Mono', size: 12 },
                            padding: 20,
                            usePointStyle: true,
                            pointStyle: 'rect',
                        }
                    },
                    tooltip: {
                        backgroundColor: '#131318',
                        titleColor: '#e4e4e7',
                        bodyColor: '#a1a1aa',
                        borderColor: '#252530',
                        borderWidth: 1,
                        padding: 12,
                        cornerRadius: 6,
                        titleFont: { family: 'Share Tech Mono', weight: 600, size: 13 },
                        bodyFont: { family: 'Share Tech Mono', size: 12 },
                        displayColors: true,
                        boxPadding: 6,
                        callbacks: {
                            label: (ctx) => `${ctx.dataset.label}: ${ctx.raw.toFixed(1)}%`
                        }
                    }
                },
                scales: {
                    x: {
                        grid: {
                            color: 'rgba(255, 255, 255, 0.05)',
                            drawBorder: false,
                        },
                        ticks: {
                            color: '#52525b',
                            font: { family: 'Share Tech Mono', size: 11 },
                            maxRotation: 45,
                            minRotation: 45,
                        },
                        border: {
                            color: '#252530',
                        }
                    },
                    y: {
                        min: yMin,
                        max: yMax,
                        grid: {
                            color: 'rgba(255, 255, 255, 0.05)',
                            drawBorder: false,
                        },
                        ticks: {
                            color: '#52525b',
                            font: { family: 'Share Tech Mono', size: 11 },
                            callback: (value) => value + '%'
                        },
                        border: {
                            color: '#252530',
                        },
                        title: {
                            display: true,
                            text: yAxisLabel,
                            color: '#52525b',
                            font: { family: 'Share Tech Mono', size: 11 }
                        }
                    }
                },
                interaction: {
                    mode: 'index',
                    intersect: false,
                },
            };
        }

        // ============================================================================
        // Details
        // ============================================================================

        // Helper to render performance stats
        function renderPerformanceStats(perf) {
            if (!perf || !perf.avgSearchTimeMs) return '';
            return `
                <div class="detail-row" style="margin-top: 10px; padding-top: 10px; border-top: 1px dashed var(--border-color);">
                    <span class="detail-label" style="color: var(--accent-yellow);">‚ö° Avg Search</span>
                    <span class="detail-value" style="color: var(--accent-yellow);">${perf.avgSearchTimeMs}ms</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Min / Max</span>
                    <span class="detail-value">${perf.minSearchTimeMs}ms / ${perf.maxSearchTimeMs}ms</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Total Searches</span>
                    <span class="detail-value">${perf.totalSearches}</span>
                </div>
            `;
        }

        function renderNoLiMaDetails(data) {
            const container = document.querySelector('#nolima-details .provider-details');
            const filteredData = data.filter(r => selectedProviders.nolima.has(r.provider));
            
            container.innerHTML = filteredData.map(run => `
                <div class="provider-detail-card">
                    <div class="provider-detail-header">
                        <span class="provider-color" style="background: ${PROVIDER_COLORS[run.provider] || '#6B7280'}; width: 12px; height: 12px; border-radius: 3px;"></span>
                        <span class="provider-detail-name">${run.provider}</span>
                        <span class="provider-detail-meta">${run.runId}</span>
                    </div>
                    <div class="provider-detail-body">
                        <div class="detail-row">
                            <span class="detail-label">Overall Accuracy</span>
                            <span class="detail-value">${run.accuracy.toFixed(2)}%</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Total Tests</span>
                            <span class="detail-value">${run.totalTests}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Correct Answers</span>
                            <span class="detail-value">${run.correctAnswers}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Answering Model</span>
                            <span class="detail-value">${run.answeringModel}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Judge Model</span>
                            <span class="detail-value">${run.judgeModel || 'N/A'}</span>
                        </div>
                        ${renderPerformanceStats(run.performance)}
                    </div>
                </div>
            `).join('');
        }

        function renderLongMemEvalDetails(data) {
            const container = document.querySelector('#longmemeval-details .provider-details');
            const filteredData = data.filter(r => selectedProviders.longmemeval.has(r.provider));
            
            container.innerHTML = filteredData.map(run => `
                <div class="provider-detail-card">
                    <div class="provider-detail-header">
                        <span class="provider-color" style="background: ${PROVIDER_COLORS[run.provider] || '#6B7280'}; width: 12px; height: 12px; border-radius: 3px;"></span>
                        <span class="provider-detail-name">${run.provider}</span>
                        <span class="provider-detail-meta">${run.runId}</span>
                    </div>
                    <div class="provider-detail-body">
                        <div class="detail-row">
                            <span class="detail-label">Overall Accuracy</span>
                            <span class="detail-value">${run.accuracy.toFixed(2)}%</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Total Questions</span>
                            <span class="detail-value">${run.totalQuestions}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Correct Answers</span>
                            <span class="detail-value">${run.correctAnswers}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Answering Model</span>
                            <span class="detail-value">${run.answeringModel}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Judge Model</span>
                            <span class="detail-value">${run.judgeModel || 'N/A'}</span>
                        </div>
                        ${renderPerformanceStats(run.performance)}
                    </div>
                </div>
            `).join('');
        }

        function renderLoCoMoDetails(data) {
            const container = document.querySelector('#locomo-details .provider-details');
            const filteredData = data.filter(r => selectedProviders.locomo.has(r.provider));
            
            container.innerHTML = filteredData.map(run => `
                <div class="provider-detail-card">
                    <div class="provider-detail-header">
                        <span class="provider-color" style="background: ${PROVIDER_COLORS[run.provider] || '#6B7280'}; width: 12px; height: 12px; border-radius: 3px;"></span>
                        <span class="provider-detail-name">${run.provider}</span>
                        <span class="provider-detail-meta">${run.runId}</span>
                    </div>
                    <div class="provider-detail-body">
                        <div class="detail-row">
                            <span class="detail-label">Overall Accuracy</span>
                            <span class="detail-value">${run.accuracy.toFixed(2)}%</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Total Questions</span>
                            <span class="detail-value">${run.totalQuestions}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Correct Answers</span>
                            <span class="detail-value">${run.correctAnswers}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Eval Method</span>
                            <span class="detail-value">${run.evalMethod || 'llm'}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Answering Model</span>
                            <span class="detail-value">${run.answeringModel}</span>
                        </div>
                        ${renderPerformanceStats(run.performance)}
                    </div>
                </div>
            `).join('');
        }

        // ============================================================================
        // Start
        // ============================================================================

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>

